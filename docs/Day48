
📝 Day 18: Docker 기초와 자동 복구 실습
1. 이론 정리
① 직접 설치(Native) vs 도커(Docker)
-직접 설치 (apt install): 서버 바닥에 직접 공사하는 방식. 지울 때 찌꺼기가 남고, 서버 이전 시 재설정이 매우 힘듦.
-도커 컨테이너 (docker run): 격리된 '텐트' 안에서 실행. 텐트만 걷어내면 서버는 항상 깨끗함. 버전 충돌 걱정 없음.

② 도커 실무 공정 (밀키트 비유)
-깃 브랜치 (재료 손질): 레시피를 보며 재료를 다듬고 수정하는 협업 과정
-도커 이미지 (비닐 포장): 어디서든 끓일 수 있게 진공 포장된 재료
-도커 컴포즈 (밀키트 박스): 웹 서버, DB 등 여러 포장재료를 한 박스에 담은 세트
-도커 컨테이너 (조리 및 전시): 밀키트를 뜯어 가스 불 위에서 실제로 요리 중인 상태

2. 주요 도커 명령어
docker run -d -p 8080:80 --name my-web nginx: 컨테이너 실행
docker ps: 실행 중인 컨테이너 목록 확인
docker stop/start [이름]: 컨테이너 중지 및 다시 시작
docker ps -f name=my-web: 특정 이름의 컨테이너만 필터링

3. 실습: 자동 복구 쉘 스크립트 (직접 작성)
Bash
#!/bin/bash

# 1. my_web 이라는 이름의 컨테이너가 실행중인지 확인
echo "===my_web 컨테이너 상태 점검을 시작합니다==="

# 2. 현재 돌아가는 도커 리스트 중 my_web이라는 것 갯수를 세서 
# 0개면 지금 안 돌아가는 거공, 0이 아니면 지금 돌아가는 중이다.
if [ $(docker ps -f name=my_web | grep -c my_web) -eq 0 ]; then
    echo "경고 : my_web 컨테이너가 중지되었습니다 재부팅을 하겠습니다"
    docker start my_web
else
    echo "정상 : my_web 컨테이너가 정상작동 중입니다."
fi

echo "===정검완료=="




4. 트러블 슈팅 
❌ Vim 지옥 (창 분할 사건)
상황: 오타로 창이 3개로 쪼개짐
해결: :wqa! 명령어로 모든 창을 한 번에 저장하고 탈출 성공

❌ 환경 혼동 (Local vs Remote)
상황: 내 노트북 터미널(WSL)에서 서버의 도커 명령어가 안 먹힘
해결: 도커는 설치된 기계에서만 작동함을 이해. ssh와 scp를 활용해 노트북에서 서버를 원격 제어하여 해결

❌ 도커 데몬 중지 에러
상황: Cannot connect to the Docker daemon 출력
해결: sudo service docker start로 가스레인지(도커 엔진)를 먼저 켜줌으로써 해결

❌ 쉘 문법 오타
상황: [ 뒤와 ] 앞의 공백 누락, docker를 dorcker로 오타
해결: 띄어쓰기를 철저히 지키고(문법 규칙) 오타를 수정하여 정상 작동 확인


