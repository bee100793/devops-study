🌀 [DevOps 실무 기초] Day 3: 반복문(for)을 활용한 자동화의 기초


1. 반복문(for)의 본질: "지정"
반복문은 단순히 여러 번 실행하는 것이 아니라, 어떤 범위를 '지정'해주고 그 안에서 하나씩 꺼내서 일을 시키는 것이다.

💡 for문의 3가지 '지정' 방식
-대상 직접 지정 (List): 처리할 항목을 손으로 직접 적어줄 때.
예: for folder in photo doc music

-횟수 지정 (Range): 똑같은 작업을 n번 반복하고 싶을 때.
예: for i in {1..3}

-출력 내용 지정 (Command): 명령어의 실행 결과를 하나씩 낚아챌 때. (실무 끝판왕)
예: for file in $(ls)


2. for문과 if문의 관계: "울타리와 검문소"
실무 스크립트에서는 보통 for가 윗줄에 오고, 그 안에 if가 들어가는 구조가 많다.

for (윗줄/울타리): "누구를 데려올 것인가?" (범위 지정)
 do
      if (안쪽/검문소): "데려온 놈이 조건에 맞나?" (판단과 필터링)
      fi
 done

예시: for로 모든 파일을 데려온 뒤, if로 용량이 0인 파일만 골라내서 삭제(rm)한다.



3. 오늘의 실습 코드 (정리본)
#!/bin/bash

# 여러 파일들 한번에 지정 해서 do 하겠다.
 mkdir photo doc music
 echo "포토 닥 뮤직폴더를 선택하겠습니다"

 for folder in photo doc music
 do
         echo "$folder들을  선택했습니다"
 done



 #  do 의 횟수지정 .
  for i in {1..3}
  do
          mkdir -p "temp_$i"
          echo "temp_$i 파일을 3개 만들었습니다(현재 $i 번째)"
  done



  #글자덩어리를 출력하는 명령어의 내용을 가지고 do 하겠다.
   for text in $(ls)
   do
           echo "$text 를 가지고 에코하겠습니다 "
   done
~                                   

4. 잊지 말아야 할 규칙 (Self-Correction)
변수 이름은 자유: i는 관습일 뿐, folder, num, item 등 의미 있는 이름을 써도 된다. 그치만 관습적으로 ijk 사용! 

담을 때는 그냥, 쓸 때는 $: for i in... (담기), echo $i (꺼내 쓰기).

**파라미터($1, $2)와의 차이:** 파라미터는 리눅스가 이미 '담아서 배달해준' 변수라 처음부터 $ 가 붙어 있지만, for\문의 변수는 내가 직접 '담는' 과정이므로 이름만 쓴다.

mkdir -p의 마법: 중간 폴더까지 한 번에 만들고, 이미 폴더가 있어도 에러를 내지 않아 스크립트 중단을 막아준다.

5. 오늘의 깨달음 (Troubleshooting)
왜 압축 전 cp를 하는가? 무작정 압축하는 것보다 '중간 기지(Staging)'로 파일을 모으는 과정을 거치면, 압축 전에 파일의 무결성을 검토할 수 있어 더 안전한 백업이 가능하다.

왜 ls보다 find인가? ls는 이름만 보여주지만, find는 '크기가 0인 파일'처럼 특정 조건에 맞는 파일을 입구에서부터 골라낼 수 있어 효율적이다.


